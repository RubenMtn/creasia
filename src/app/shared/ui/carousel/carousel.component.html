<!-- Carrusel: separador negro como “slide” entre imágenes, sin parada -->
<section
  #wrapEl
  class="carousel"
  [style.height]="height"
  role="region"
  aria-roledescription="carousel"
  [attr.aria-label]="'Carrusel de imágenes (' + images.length + ' ítems)'"
  tabindex="0"
  (mouseenter)="onMouseEnter()"
  (mouseleave)="onMouseLeave()"
>
  <!-- Pista que se desplaza en píxeles -->
  <div
    #trackEl
    class="track"
    [class.notransition]="!enableTransition"
    [style.transform]="'translateX(' + (-translateXPx) + 'px)'"
    [style.transition]="enableTransition ? 'transform ' + transitionMs + 'ms ease-in-out' : 'none'"
    [style.height]="height"
    (transitionend)="onTrackTransitionEnd($event)"
  >
    <!-- Render extendido (con clones). Cada slide tiene su ancho inline -->
    <ng-container *ngFor="let sl of extSlides; let i = index">
      <!-- Imagen -->
      <div
        *ngIf="sl.kind === 'img'; else sepTpl"
        class="slide img-slide"
        [style.width.px]="slideW[i]"
        [style.height]="height"
      >
        <a *ngIf="sl.data.link; else nolink" [href]="sl.data.link" class="slide-link" tabindex="-1" aria-hidden="true">
          <img class="slide-img" [src]="sl.data.src" [alt]="sl.data.alt || ''" loading="lazy" />
          <div *ngIf="sl.data.caption" class="caption">{{ sl.data.caption }}</div>
        </a>
        <ng-template #nolink>
          <img class="slide-img" [src]="sl.data.src" [alt]="sl.data.alt || ''" loading="lazy" />
          <div *ngIf="sl.data.caption" class="caption">{{ sl.data.caption }}</div>
        </ng-template>
      </div>

      <!-- Separador negro (slide real, sin dwell) -->
      <ng-template #sepTpl>
        <div
          class="slide sep-slide"
          [style.width.px]="slideW[i]"
          [style.height]="height"
          [style.background]="separatorColor"
          aria-hidden="true"
        ></div>
      </ng-template>
    </ng-container>
  </div>

  <!-- Flechas -->
  <button
    *ngIf="showArrows && images.length > 1"
    class="nav nav-prev"
    type="button"
    aria-label="Anterior"
    (click)="prev()"
  >&#10094;</button>
  <button
    *ngIf="showArrows && images.length > 1"
    class="nav nav-next"
    type="button"
    aria-label="Siguiente"
    (click)="next()"
  >&#10095;</button>

  <!-- Indicadores (solo por imágenes reales) -->
  <div *ngIf="showIndicators && images.length > 1" class="indicators" role="tablist" aria-label="Indicadores">
    <button
      *ngFor="let _ of images; let i = index"
      type="button"
      class="dot"
      [class.active]="i === current"
      (click)="goTo(i)"
      [attr.aria-label]="'Ir a la diapositiva ' + (i + 1)"
      [attr.aria-selected]="i === current"
      role="tab"
    ></button>
  </div>
</section>
