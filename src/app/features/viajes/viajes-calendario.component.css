/* ============================================================
   Archivo: src/app/features/viajes/viajes-calendario.component.css
   Calendario Viajes — Alto contraste sobre fondo NEGRO
   ------------------------------------------------------------
   ✅ Celdas cuadradas garantizadas (1:1) en todos los tamaños.
   ✅ Fallback para navegadores sin aspect-ratio.
   ✅ La tabla ocupa un poco más a lo ancho.
   ✅ Espaciado entre filas = columnas.
   ============================================================ */

/* === Variables locales del componente === */
:host {
  /* Proporción ancho/alto de cada día → celdas cuadradas */
  --cell-aspect: 1;

  /* Altura mínima “de seguridad” (no debe superar el ancho de una celda) */
  /* 14cqw ≈ 100/7 del ancho de la tarjeta (7 días), ajustado por gaps */
  --cell-min: clamp(44px, 14cqw, 54px);

  /* Gaps iguales en X e Y */
  --cell-gap-x: 0.45rem;
  --cell-gap-y: 0.45rem;

  display: block;
}

/* Contenedor principal */
.cal-root {
  background: #000;
  color: #fff;
  padding: .25rem;
}

/* Título */
.cal-title {
  font-size: 1.3rem;
  margin: 0 0 1rem;
  color: #fff;
}

/* Estados */
.cal-state,
.cal-error {
  padding: .8rem 1rem;
  border-radius: .6rem;
  border: 1px solid #2b2b2b;
  background: #0f0f0f;
  color: #fff;
}

.cal-error {
  border-left: 4px solid #e11d48;
}

/* === Grid de meses === */
.cal-grid {
  display: grid;
  gap: 1.1rem;
  grid-template-columns: 1fr;
}

@media (min-width: 640px) {
  .cal-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
}

@media (min-width: 1024px) {
  .cal-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
}

/* Tarjeta de mes (activamos container para cqw) */
.cal-month {
  border: 1px solid #2b2b2b;
  border-radius: 12px;
  background: #000;
  box-shadow: 0 1px 6px rgba(0, 0, 0, .45);

  /* Reducimos padding para que la tabla “respire” más a lo ancho */
  padding: .5rem .55rem;

  /* Para que 1cqw mida el ancho de la tarjeta (útil para --cell-min) */
  container-type: inline-size;
}

.cal-month__header { margin-bottom: .55rem; }

.cal-month__title {
  margin: 0;
  font-size: 1.05rem;
  font-weight: 750;
  color: #fff;
}

/* === Tabla mensual === */
.cal-table {
  width: 100%;
  table-layout: fixed;            /* columnas iguales */
  border-collapse: separate;      /* necesario para border-spacing */
  border-spacing: var(--cell-gap-x) var(--cell-gap-y);
}

.cal-table thead th {
  font-weight: 700;
  font-size: .95rem;
  text-align: center;
  color: #e5e7eb;                 /* blanco roto */
  padding: .35rem 0;
  border-bottom: 1px solid #2b2b2b;
}

.cal-table tbody td {
  padding: 0;
  vertical-align: top;            /* evita estirones por contenido */
}

/* ---------- Estructura de cada día ----------
  <td [class.is-outside]="...">
    <div class="cell [tone-0|tone-1|tone-2|tone-3]">
      <span class="num">…</span>
      <span class="badge">…</span>
    </div>
  </td>
------------------------------------------------ */

/* Wrapper del día (div) — aquí forzamos CUADRADO */
.cal-table .cell {
  position: relative;
  display: grid;
  place-items: center;

  /* ✅ Cuadrado nativo (ancho = alto) */
  aspect-ratio: var(--cell-aspect) / 1;

  /* Altura mínima de seguridad (no pisa la proporción al ser ≤ ancho celda) */
  min-block-size: var(--cell-min);

  border: 1px solid #333;
  border-radius: .7rem;
  overflow: hidden;

  background: #ffffff;            /* día sin interés → blanco */
  color: #111;                    /* texto oscuro */
}

/* Fallback robusto para navegadores SIN aspect-ratio */
@supports not (aspect-ratio: 1 / 1) {
  .cal-table .cell {
    /* Quitamos la dependencia de min-block-size para no romper el cuadrado */
    min-block-size: 0;
  }
  .cal-table .cell::before {
    content: "";
    display: block;
    width: 100%;
    padding-top: calc(100% / var(--cell-aspect)); /* alto = ancho */
    grid-area: 1 / 1;
  }
  .cal-table .cell > * {
    grid-area: 1 / 1; /* contenido encima del spacer */
  }
}

/* Tonos por nº de interesados */
.cal-table .tone-0 {
  background: #ffffff !important;
  color: #111 !important;
}
.cal-table .tone-1 {
  background: #ffe466 !important;
  color: #111 !important;
}
.cal-table .tone-2 {
  background: #ffd400 !important;
  color: #111 !important;
}
.cal-table .tone-3 {
  background: goldenrod !important;
  color: #111 !important;
}

/* Días fuera del mes */
.cal-table .is-outside .cell {
  background: #171717 !important;
  color: #9ca3af !important;
  border-style: dashed;
}

/* Tipografía interna */
.cal-table .num {
  font-size: 1.15rem;   /* presencia del número del día */
  line-height: 1;
  font-weight: 800;
  position: relative;
  top: 2px;             /* ajuste fino */
}

.cal-table .badge {
  position: absolute;
  right: .1rem;
  top: .05rem;          /* posición vertical del contador */
  min-width: 1.5rem;
  height: 1.5rem;
  padding: 0 .2rem;
  background: transparent !important;
  color: white !important;
  font-size: 1rem;
  font-weight: 900;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 0;
  pointer-events: none; /* no bloquea clics */
  text-shadow: 0 0 2px #fff; /* mejora lectura sobre amarillos */
}

/* Leyenda */
.cal-legend {
  display: flex;
  gap: .95rem;
  align-items: center;
  margin-top: .9rem;
  color: #e5e7eb;
  font-size: .95rem;
}

.cal-legend .swatch {
  width: 1.15rem;
  height: 1.15rem;
  border-radius: .35rem;
  border: 1px solid #333;
  display: inline-block;
  margin-right: .35rem;
  vertical-align: -2px;
}

.cal-legend .tone-0 { background: #ffffff; }
.cal-legend .tone-1 { background: #ffe466; }
.cal-legend .tone-2 { background: #ffd400; }
.cal-legend .tone-3 { background: goldenrod; }

.cal-legend--top { color: #fff; }
.cal-legend--top strong { margin-right: .4rem; }


/* === Selección por rango (azules suaves) === */
:host {
  --sel-bg: rgba(37, 99, 235, 0.16);       /* azul suave */
  --sel-bg-strong: rgba(37, 99, 235, 0.22);
  --sel-outline: rgba(37, 99, 235, 0.55);
}

/* Celda inicio/fin o selección única */
.cal-table td.is-selected,
.cal-table td.is-selected .cell {
  background: var(--sel-bg-strong);
  outline: 2px solid var(--sel-outline);
  outline-offset: -2px; /* que quede dentro */
}

/* Celdas intermedias del rango */
.cal-table td.is-in-range,
.cal-table td.is-in-range .cell {
  background: var(--sel-bg);
}

/* Aviso de login por mes */
.login-hint {
  margin-top: 0.5rem;
  color: #fbbf24;           /* aviso en amarillo cálido */
  font-size: 0.95rem;
}

/* Acciones globales (guardar) */
.cal-actions {
  display: flex;
  gap: 0.75rem;
  align-items: center;
  margin-top: 0.75rem;
}

.btn-save {
  border: 0;
  border-radius: 0.6rem;
  padding: 0.5rem 0.9rem;
  background: #1d4ed8;      /* azul */
  color: #fff;
  cursor: pointer;
}
.btn-save:hover { filter: brightness(1.06); }
.range-label { opacity: 0.9; }

/* === Selección por rango con contorno (sin cubrir tonos) === */
:host {
  --sel-outline: rgba(37, 99, 235, 0.7); /* azul accesible */
}

.cal-table td.is-selected .cell {
  /* extremos del rango o selección única */
  box-shadow: inset 0 0 0 2px var(--sel-outline);
  border-radius: 0.4rem;
}

.cal-table td.is-in-range .cell {
  /* interior del rango (contorno más sutil) */
  box-shadow: inset 0 0 0 1px var(--sel-outline);
  border-radius: 0.35rem;
}

/* ===========================
   Tamaño de la etiqueta fechas
   - Móvil: base (heredada)
   - Tablet/PC: un poco más pequeña
   =========================== */

.range-label {
  /* base móvil; si ya tienes tamaño, respétalo */
  font-size: 0.95rem; /* opcional, ajusta a tu escala */
}

/* Tablet en adelante */
@media (min-width: 768px) {
  .range-label {
    font-size: 0.85rem;  /* un paso más pequeña */
    opacity: 0.9;        /* sutilmente más discreta */
  }
}

/* Desktop medio+ (opcional) */
@media (min-width: 1024px) {
  .range-label {
    font-size: 0.8rem;   /* otro paso si quieres compactar más */
    opacity: 0.85;
  }
}
